---
import { getCollection } from "astro:content";
import BaseLayout from "../../../layouts/base.astro";
import Navbar from "../../../components/navbar.astro";
import JAILogo from "../../../components/jai-logo.astro";
import JAIWord from "../../../components/islands/jai-word";
import Search from "../../../components/islands/search.jsx";
import { capitalizeText } from "../../../lib/utils/index.js";

const dictionary = await getCollection("dictionary");

const word = Astro.url.searchParams.get("word");
if (!word) return Astro.redirect("/");

const title = capitalizeText(word);
---

<BaseLayout pageTitle={`${title} - âœ¨jAI Generated Meaning`}>
  <Navbar>
    <Search triggerSize="sm" dictionary={dictionary} client:load />
  </Navbar>

  <main class="max-w-screen-lg p-5 md:mt-10 mx-auto min-h-screen space-y-6">
    <div class="w-full">
      <h1 class="text-3xl md:text-7xl font-black">
        {title}
      </h1>
      <!-- Metatab -->
      <div class="flex mt-6 justify-between">
        <div class="grow flex items-center space-x-2 -z-10">
          <span class="text-sm">Generated by</span>
          <JAILogo class="w-14 drop-shadow-md" />
        </div>

        <!-- TODO: AI Contribution Prompt Button 
          - Add a button that prompts user to contribute the AI-generated meaning to dictionary 
          ...ideas in roadmap at - https://github.com/jargonsdev/roadmap/issues/9 
        -->
      </div>
    </div>

    <!-- jAI Generated Word Meaning -->
    <article class="w-full max-w-screen-lg prose">
      <JAIWord word={word} client:load />
    </article>

    <!-- TODO: Track Word whose meaning was generated by jAI 
      - Add a way to track words whose meanings were generated by jAI
      - Maybe add the word to search history like other words?
      | - but we'll have to manage how to differentiate between user searched words and jAI generated words
      | - we could add a tag or label to indicate the source of the word
      | - this way, users can see which words were generated by jAI and which were searched by them
    -->
  </main>
</BaseLayout>
